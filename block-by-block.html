<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>ðŸŽµ Block by Block â€“ First edition</title>
<style>
  body {
    margin: 0;
    height: 100vh;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    font-family: 'Segoe UI', sans-serif;
    color: white;
    text-align: center;
    background: linear-gradient(270deg, #ff00ff, #00ffff, #ff9900, #00ff99);
    background-size: 800% 800%;
    animation: neonBG 15s ease infinite;
  }
  @keyframes neonBG {
    0% {background-position: 0% 50%;}
    50% {background-position: 100% 50%;}
    100% {background-position: 0% 50%;}
  }
  h1 {
    font-size: 2.5em;
    text-shadow: 0 0 10px #fff, 0 0 20px #ff00ff, 0 0 30px #00ffff;
    margin-bottom: 20px;
  }
  button {
    padding: 15px 30px;
    font-size: 1.2em;
    border: none;
    border-radius: 8px;
    background: #111;
    color: white;
    cursor: pointer;
    box-shadow: 0 0 10px #ff00ff, 0 0 20px #00ffff;
    transition: transform 0.2s ease, box-shadow 0.3s ease;
  }
  button:hover {
    transform: scale(1.05);
    box-shadow: 0 0 20px #ff00ff, 0 0 40px #00ffff;
  }
</style>
</head>
<body>

<h1>ðŸŽµ Block by Block â€“ Smooth Neon Edition</h1>
<button onclick="playSong()">Play Song</button>

<script>
const NOTES = {
  "C4":261.63,"D4":293.66,"E4":329.63,"F4":349.23,"G4":392.00,"A4":440.00,"B4":493.88,
  "C3":130.81,"D3":146.83,"E3":164.81,"F3":174.61,"G3":196.00,"A3":220.00,"B3":246.94,
  "REST":0
};

const CHORDS = {
  "C":["C4","E4","G4"],
  "F":["F4","A4","C4"],
  "G":["G4","B4","D4"],
  "Am":["A4","C4","E4"]
};

// Smooth groove pattern
const song = [
  ["C4","C","C3",0.6],["C4","C","C3",0.6],["E4","C","C3",0.6],["G4","C","C3",0.6],
  ["G4","F","F3",0.6],["E4","F","F3",0.6],["D4","G","G3",0.6],["C4","G","G3",0.6],
  ["E4","Am","A3",0.6],["E4","Am","A3",0.6],["G4","F","F3",0.6],["A4","F","F3",0.6],
  ["G4","C","C3",0.6],["E4","C","C3",0.6],["D4","G","G3",0.6],["C4","G","G3",1.2]
];

const intro = [
  ["E4","C","C3",0.6],["G4","C","C3",0.6],["A4","F","F3",0.6],["G4","F","F3",0.6]
];
const bridge = [
  ["A4","Am","A3",0.6],["G4","F","F3",0.6],["E4","G","G3",0.6],["F4","C","C3",0.6]
];
const outro = [
  ["C4","C","C3",0.6],["E4","C","C3",0.6],["G4","C","C3",1.8]
];

function playTone(ctx, freq, dur, start, type="sawtooth", vol=0.2) {
  if (freq===0) return;
  const osc = ctx.createOscillator();
  const gain = ctx.createGain();
  const filter = ctx.createBiquadFilter();

  osc.type = type;
  osc.frequency.value = freq;

  filter.type = "lowpass";
  filter.frequency.setValueAtTime(8000, start);

  osc.connect(filter);
  filter.connect(gain);
  gain.connect(ctx.destination);

  // Smooth attack/release
  gain.gain.setValueAtTime(0, start);
  gain.gain.linearRampToValueAtTime(vol, start+0.05);
  gain.gain.linearRampToValueAtTime(vol*0.9, start+dur-0.05);
  gain.gain.linearRampToValueAtTime(0, start+dur);

  osc.start(start);
  osc.stop(start+dur+0.05); // overlap for smoothness
}

function playBackgroundPad(ctx, chord, start, dur) {
  CHORDS[chord].forEach(n => {
    const osc = ctx.createOscillator();
    const gain = ctx.createGain();
    osc.type = "triangle";
    osc.frequency.value = NOTES[n]/2; // lower octave pad
    osc.connect(gain);
    gain.connect(ctx.destination);
    gain.gain.setValueAtTime(0.05, start);
    gain.gain.linearRampToValueAtTime(0.04, start+dur);
    osc.start(start);
    osc.stop(start+dur);
  });
}

function playDrum(ctx, type, start, vol=0.3) {
  const osc = ctx.createOscillator();
  const gain = ctx.createGain();
  osc.connect(gain);
  gain.connect(ctx.destination);

  if (type === "kick") {
    osc.type = "sine";
    osc.frequency.setValueAtTime(150, start);
    osc.frequency.exponentialRampToValueAtTime(50, start + 0.15);
  } else if (type === "snare") {
    osc.type = "triangle";
    osc.frequency.setValueAtTime(200, start);
  } else if (type === "hihat") {
    osc.type = "square";
    osc.frequency.setValueAtTime(400, start);
  }

  gain.gain.setValueAtTime(vol, start);
  gain.gain.exponentialRampToValueAtTime(0.001, start + 0.1);

  osc.start(start);
  osc.stop(start + 0.1);
}

function playSection(ctx, section, dynamics=1.0, t) {
  section.forEach(([mel, chord, bass, dur], i) => {
    // Lead
    playTone(ctx, NOTES[mel], dur, t, "sawtooth", 0.25*dynamics);
    // Chords
    CHORDS[chord].forEach(n => playTone(ctx, NOTES[n], dur, t, "triangle", 0.12*dynamics));
    // Bass
    playTone(ctx, NOTES[bass], dur, t, "square", 0.18*dynamics);
    // Background pad
    playBackgroundPad(ctx, chord, t, dur*2);

    // Drums
    if (Math.random() > 0.2) playDrum(ctx, "hihat", t, 0.12*dynamics);
    if (i % 4 === 0) playDrum(ctx, "kick", t, 0.3*dynamics);
    if (i % 4 === 2) playDrum(ctx, "snare", t, 0.25*dynamics);

    t += dur * 0.95; // slight overlap for smoothness
  });
  return t;
}

function playSong() {
  const ctx = new (window.AudioContext || window.webkitAudioContext)();
  let t = ctx.currentTime + 0.1;

  t = playSection(ctx, intro, 0.6, t);
  t = playSection(ctx, song, 0.85, t);
  t = playSection(ctx, bridge, 0.75, t);
  t = playSection(ctx, song, 1.0, t);
  t = playSection(ctx, outro, 0.5, t);
}
</script>

</body>
</html>
